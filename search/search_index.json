{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Utvikler docs Her finner du teknisk informasjon om hvordan teamet ditt kan f\u00e5 inn innhold p\u00e5 min side. Ta gjerne en titt p\u00e5 innholdsguiden f\u00f8r du setter i gang! Se dokumentasjon p\u00e5 Aksel for eksempler og mer om hvordan de forskjellige produktene skal brukes.","title":"Home"},{"location":"#utvikler-docs","text":"Her finner du teknisk informasjon om hvordan teamet ditt kan f\u00e5 inn innhold p\u00e5 min side. Ta gjerne en titt p\u00e5 innholdsguiden f\u00f8r du setter i gang! Se dokumentasjon p\u00e5 Aksel for eksempler og mer om hvordan de forskjellige produktene skal brukes.","title":"Utvikler docs"},{"location":"guide/","text":"Innholdsguide Usikker p\u00e5 hvilken type innholdet ditt er? Sjekk ut figma-veilederen v\u00e5r !","title":"Innholdsguide"},{"location":"guide/#innholdsguide","text":"Usikker p\u00e5 hvilken type innholdet ditt er? Sjekk ut figma-veilederen v\u00e5r !","title":"Innholdsguide"},{"location":"microfrontend/","text":"Microfrontends p\u00e5 min side Mikrofrontends gir teamene mulighet til \u00e5 presentere den viktigste informasjonen til brukerne sine p\u00e5 Min side, som et lite butikkvindu inn til teamenes egne l\u00f8sninger. Dette gj\u00f8res gjennom at mikrofrontenden blir bygget til ESM og deretter hentes inn som en remote ES-Modul. Nice! Hvordan kan mitt team f\u00e5 en mikrofrontend p\u00e5 min side? 1. Lag en mikrofrontend! Om du vil bruke et template finnes det ett for typescript og ett for javascript 2. Sett opp oppdatering av url til den gjeldene javascript-koden Be om \u00e5 f\u00e5 installert min-side-repo-authenticator Legg inn action-secrets PRIVATE_KEY og APP_ID (disse f\u00e5r du fra min-side teamet) Legg inn oppdateringsworkflow i github workflows mappa til prosjektet name: Update microfrontend-manifest on: <\u00f8nsket hook> jobs: trigger_manifest_update: uses: navikt/tms-deploy/.github/workflows/oppdater-mikrofrontend-manifest.yaml@main with: cluster: \"<cluster: dev-gcp eller prod-gcp>\" id: \"<microfrontend_id>\" url: \"<url til js-kode i cdn>\" secrets: inherit ``` #### Hvordan vet jeg hva urlen til javascriptet er? Om du bruker `navikt/frontend/actions/cdn-upload/v1@main`: 1. Hent path fra cdn-upload outputs(`${{ <steps/jobs>.<id til cdn-upload step eller job>.outputs.uploaded }}`) 2. Legg til host (`https://cdn.nav.no`) ```bash files=\"${{ <steps/jobs>.<id til cdn-upload step eller job>.outputs.uploaded }}\" cdn_path=$(echo $files|cut -d \",\" -f <index til js-url i liste>) cdn_url=\"https://cdn.nav.no/$cdn_path\" Eksempel finnes i workflows-mappa til tms-mikrofrontend-selector NB: Urlen skal v\u00e6re til js-koden , ikke json-manifest. 3. Koble til l\u00f8sningen Opprett et issue i tms-min-side repoet , be om \u00e5 f\u00e5 lagt inn mikrofrontenden i kode og avtal en <microfrontendId> Koble p\u00e5 min-side-microfrontend-topicet ## Enable/disable Om en mikrofrontend vises avhenger av om den er enablet for en gitt bruker. Dette setter du ved \u00e5 sende en melding p\u00e5 microfrontend-topicet. ### Enable-melding n\u00e5r en bruker skal se mikrofrontenden { \"@action\": \"enable\", \"ident\": <ident for bruker: fnr/dnr>, \"microfrontend_id\": <microfrontendId>, \"sensitivitet\": <niv\u00e5 som kreves for \u00e5 se innholdet i mikrofrontenden, gyldige verdier: substantial og high>, \"@initiated_by\": <ditt-team> } ### Disable-melding n\u00e5r bruker ikke skal se mikrofrontenden lenger { \"@action\": \"disable\", \"ident\": <ident for bruker: fnr/dnr>, \"microfrontend_id\": <microfrontendId>, \"@initiated_by\":<ditt-team> } Meldingsbygger-bibliotek Det er tilgjengelig p\u00e5 github packages Spr\u00e5k Vi bruker spr\u00e5kvelgeren i Dekorat\u00f8ren. For \u00e5 vite hvilket spr\u00e5k man skal vise s\u00e5 sender vi et event via session storage. Man kan enkelt sette opp en provider som vi har gjort her . Shared dependencies For \u00e5 unng\u00e5 \u00e5 ha for store bundles s\u00e5 deler vi noen dependencies p\u00e5 tvers av apper. Disse hentes ned en gang ved f\u00f8rste page load fra en CDN og caches i browseren. Forel\u00f8pig ligger react, react-dom og ds-css i CDNen. CSSen fra designsystemet hentes i skallet til Min side. Denne skal deles p\u00e5 tvers og ikke bundles med i mikrofrontenden. Vi b\u00f8r ligge p\u00e5 samme major versjon, veilendende versjon ligger her . FAQ Hva b\u00f8r jeg velge som mikrofrontend-id? <omr\u00e5de>.<tjenste> er et bra utgangspunkt, pr\u00f8v \u00e5 holde det s\u00e5 generelt som mulig, men gjenkjenbart. Hvordan skal mikrofrontenden se ut? Vi bruker en modifisert versjon av designsystemet. Ta kontakt med oss for \u00e5 se hvordan en ny mikrofrontend kan passe inn i Min side. Hvordan fungerer amplitude? Amplitude fungerer som vanlig ( se AAP sin mikrofrontend ). Dere kan fritt logge de eventene dere vil, men for \u00e5 sette opp m\u00e5linger p\u00e5 tvers i Amplitude har vi disse f\u00f8ringene p\u00e5 navigasjonseventer : komponent: tekstlig representasjon av komponenten det ble trykket p\u00e5. Videre anbefaler vi \u00e5 f\u00f8lge taksonominen i NAV. Hva er sensitivitet? Feltet sensitivitet i enablemeldingen korresponderer direkte til de nye acr-veridene i IDporten token. Om informasjonen som vises krever idporten-loa-high innlogging skal sensitivitet settes til high . Om informasjonen kan vises uavhengig av innloggingsniv\u00e5 skal sensitivitet settes til substantial . Om sensitivitet ikke er spesifisert i kafka-meldingen settes det alltid til high hos oss. Om en person logger inn med idporten-loa-substantial og det finnes mikrofrontender som personen kan se p\u00e5 idporten-loa-high vil bruker f\u00e5 beskjed om dette og link til en \"stepup\" login. Se ogs\u00e5 NAIS docs for mer info om acr-verdiene Observability Hendelser blir logget til kibana med customfelter for filtrering \\ Alle microfrontends: x_contenttype:\"microfrontend \\ Spesifik microfrontend: x_minside_id :\"<microfrontendid>\"","title":"Microfrontend"},{"location":"microfrontend/#microfrontends-pa-min-side","text":"Mikrofrontends gir teamene mulighet til \u00e5 presentere den viktigste informasjonen til brukerne sine p\u00e5 Min side, som et lite butikkvindu inn til teamenes egne l\u00f8sninger. Dette gj\u00f8res gjennom at mikrofrontenden blir bygget til ESM og deretter hentes inn som en remote ES-Modul.","title":"Microfrontends p\u00e5 min side"},{"location":"microfrontend/#nice-hvordan-kan-mitt-team-fa-en-mikrofrontend-pa-min-side","text":"","title":"Nice! Hvordan kan mitt team f\u00e5 en mikrofrontend p\u00e5 min side?"},{"location":"microfrontend/#1-lag-en-mikrofrontend","text":"Om du vil bruke et template finnes det ett for typescript og ett for javascript","title":"1. Lag en mikrofrontend!"},{"location":"microfrontend/#2-sett-opp-oppdatering-av-url-til-den-gjeldene-javascript-koden","text":"Be om \u00e5 f\u00e5 installert min-side-repo-authenticator Legg inn action-secrets PRIVATE_KEY og APP_ID (disse f\u00e5r du fra min-side teamet) Legg inn oppdateringsworkflow i github workflows mappa til prosjektet name: Update microfrontend-manifest on: <\u00f8nsket hook> jobs: trigger_manifest_update: uses: navikt/tms-deploy/.github/workflows/oppdater-mikrofrontend-manifest.yaml@main with: cluster: \"<cluster: dev-gcp eller prod-gcp>\" id: \"<microfrontend_id>\" url: \"<url til js-kode i cdn>\" secrets: inherit ``` #### Hvordan vet jeg hva urlen til javascriptet er? Om du bruker `navikt/frontend/actions/cdn-upload/v1@main`: 1. Hent path fra cdn-upload outputs(`${{ <steps/jobs>.<id til cdn-upload step eller job>.outputs.uploaded }}`) 2. Legg til host (`https://cdn.nav.no`) ```bash files=\"${{ <steps/jobs>.<id til cdn-upload step eller job>.outputs.uploaded }}\" cdn_path=$(echo $files|cut -d \",\" -f <index til js-url i liste>) cdn_url=\"https://cdn.nav.no/$cdn_path\" Eksempel finnes i workflows-mappa til tms-mikrofrontend-selector NB: Urlen skal v\u00e6re til js-koden , ikke json-manifest.","title":"2. Sett opp oppdatering av url til den gjeldene javascript-koden"},{"location":"microfrontend/#3-koble-til-lsningen","text":"Opprett et issue i tms-min-side repoet , be om \u00e5 f\u00e5 lagt inn mikrofrontenden i kode og avtal en <microfrontendId> Koble p\u00e5 min-side-microfrontend-topicet ## Enable/disable Om en mikrofrontend vises avhenger av om den er enablet for en gitt bruker. Dette setter du ved \u00e5 sende en melding p\u00e5 microfrontend-topicet. ### Enable-melding n\u00e5r en bruker skal se mikrofrontenden { \"@action\": \"enable\", \"ident\": <ident for bruker: fnr/dnr>, \"microfrontend_id\": <microfrontendId>, \"sensitivitet\": <niv\u00e5 som kreves for \u00e5 se innholdet i mikrofrontenden, gyldige verdier: substantial og high>, \"@initiated_by\": <ditt-team> } ### Disable-melding n\u00e5r bruker ikke skal se mikrofrontenden lenger { \"@action\": \"disable\", \"ident\": <ident for bruker: fnr/dnr>, \"microfrontend_id\": <microfrontendId>, \"@initiated_by\":<ditt-team> }","title":"3. Koble til l\u00f8sningen"},{"location":"microfrontend/#meldingsbygger-bibliotek","text":"Det er tilgjengelig p\u00e5 github packages","title":"Meldingsbygger-bibliotek"},{"location":"microfrontend/#sprak","text":"Vi bruker spr\u00e5kvelgeren i Dekorat\u00f8ren. For \u00e5 vite hvilket spr\u00e5k man skal vise s\u00e5 sender vi et event via session storage. Man kan enkelt sette opp en provider som vi har gjort her .","title":"Spr\u00e5k"},{"location":"microfrontend/#shared-dependencies","text":"For \u00e5 unng\u00e5 \u00e5 ha for store bundles s\u00e5 deler vi noen dependencies p\u00e5 tvers av apper. Disse hentes ned en gang ved f\u00f8rste page load fra en CDN og caches i browseren. Forel\u00f8pig ligger react, react-dom og ds-css i CDNen. CSSen fra designsystemet hentes i skallet til Min side. Denne skal deles p\u00e5 tvers og ikke bundles med i mikrofrontenden. Vi b\u00f8r ligge p\u00e5 samme major versjon, veilendende versjon ligger her .","title":"Shared dependencies"},{"location":"microfrontend/#faq","text":"","title":"FAQ"},{"location":"microfrontend/#hva-br-jeg-velge-som-mikrofrontend-id","text":"<omr\u00e5de>.<tjenste> er et bra utgangspunkt, pr\u00f8v \u00e5 holde det s\u00e5 generelt som mulig, men gjenkjenbart.","title":"Hva b\u00f8r jeg velge som mikrofrontend-id?"},{"location":"microfrontend/#hvordan-skal-mikrofrontenden-se-ut","text":"Vi bruker en modifisert versjon av designsystemet. Ta kontakt med oss for \u00e5 se hvordan en ny mikrofrontend kan passe inn i Min side.","title":"Hvordan skal mikrofrontenden se ut?"},{"location":"microfrontend/#hvordan-fungerer-amplitude","text":"Amplitude fungerer som vanlig ( se AAP sin mikrofrontend ). Dere kan fritt logge de eventene dere vil, men for \u00e5 sette opp m\u00e5linger p\u00e5 tvers i Amplitude har vi disse f\u00f8ringene p\u00e5 navigasjonseventer : komponent: tekstlig representasjon av komponenten det ble trykket p\u00e5. Videre anbefaler vi \u00e5 f\u00f8lge taksonominen i NAV.","title":"Hvordan fungerer amplitude?"},{"location":"microfrontend/#hva-er-sensitivitet","text":"Feltet sensitivitet i enablemeldingen korresponderer direkte til de nye acr-veridene i IDporten token. Om informasjonen som vises krever idporten-loa-high innlogging skal sensitivitet settes til high . Om informasjonen kan vises uavhengig av innloggingsniv\u00e5 skal sensitivitet settes til substantial . Om sensitivitet ikke er spesifisert i kafka-meldingen settes det alltid til high hos oss. Om en person logger inn med idporten-loa-substantial og det finnes mikrofrontender som personen kan se p\u00e5 idporten-loa-high vil bruker f\u00e5 beskjed om dette og link til en \"stepup\" login. Se ogs\u00e5 NAIS docs for mer info om acr-verdiene","title":"Hva er sensitivitet?"},{"location":"microfrontend/#observability","text":"Hendelser blir logget til kibana med customfelter for filtrering \\ Alle microfrontends: x_contenttype:\"microfrontend \\ Spesifik microfrontend: x_minside_id :\"<microfrontendid>\"","title":"Observability"},{"location":"utkast/","text":"Utkast p\u00e5 min side \u2013 en enklere inngang til p\u00e5begynte s\u00f8knader og dokument-innsendinger \\ Utkast er underside av min side (tilgjengelig p\u00e5 <navurl>/minside/utkast ) der bruker skal kunne finne s\u00f8knader og dokument-innsendinger hen har begynt \u00e5 fylle ut, men ikke sendt inn enda. Utkast er bruker-initiert Det kan v\u00e6re innsendinger eller s\u00f8knader som en person har startet p\u00e5, men ikke sendt inn. Et utkast er i \u00f8yeblikket ikke en del av en persons interaksjon med NAV , selv om det kan bli det. Eksempel: En p\u00e5begynt s\u00f8knad. Den kan sendes inn, eller en bruker kan velge \u00e5 ikke sende den inn. Hvordan fungerer det? Koble p\u00e5 min-side-utkast-iac-topicet og kj\u00f8r p\u00e5! \\ utkast st\u00f8tter tre hendelser: created, updated, og deleted 1. Send en created-melding n\u00e5r en bruker har lagra ett utkast 2. Send en updated-melding hvis url-en eller tittelen til utkastet har endret seg. 3. Send en deleted melding n\u00e5r bruker enten har sendt inn eller hvis utkastet har blitt slettet enten av bruker eller systemet. Kafka topic : aapen-utkast-v1 \\ tilgang : min-side-utkast-iac-topic \\ hendelser : created , updated , deleted meldingsformat create og update { \"@event_name\": \"<operasjon>\", \"utkastId\": \"<uuid>\", \"ident\": \"<fnr eller lignende>\", \"link\": \"<link til utkast>\", \"tittel\": \"<tittel p\u00e5 utkast>\", \"tittel_i18n\": { \"<spr\u00e5kkode>\": \"oversatt tittel\" }, \"metrics\": { \"skjemanavn\": \"<skjema navn>\", \"skjemakode\": \"<NAV skjemakode>\" } } obligatoriske felt : @event_name , utkastId , \"ident\" , \"tittel\" delete { \"@event_name\": \"deleted\", \"utkastId\": \"<uuid>\" } Det finnes ogs\u00e5 et message-builder bibliotek som lager meldingene for deg. NB! Det er kun ting som ikke er innsendt som skal ligge p\u00e5 utkast-siden. Observability Hendelser blir logget til kibana med customfelter for filtrering \\ Alle utkast: x_contenttype:\"utkast\" \\ Spesifikt utkast: x_minside_id :\"<utkastid>\" Amplitude m\u00e5linger Utkast-frontenden logger ett skjema \u00e5pent event med url som payload til amplitude n\u00e5r bruker klikker p\u00e5 ett utkast. Om teamet ditt \u00f8nsker \u00e5 f\u00e5 med feltene skjemakode og skjemanavn m\u00e5 metricsfeltet v\u00e6re tilstede og komplett i create-meldingen","title":"Utkast"},{"location":"utkast/#utkast-pa-min-side","text":"\u2013 en enklere inngang til p\u00e5begynte s\u00f8knader og dokument-innsendinger \\ Utkast er underside av min side (tilgjengelig p\u00e5 <navurl>/minside/utkast ) der bruker skal kunne finne s\u00f8knader og dokument-innsendinger hen har begynt \u00e5 fylle ut, men ikke sendt inn enda. Utkast er bruker-initiert Det kan v\u00e6re innsendinger eller s\u00f8knader som en person har startet p\u00e5, men ikke sendt inn. Et utkast er i \u00f8yeblikket ikke en del av en persons interaksjon med NAV , selv om det kan bli det. Eksempel: En p\u00e5begynt s\u00f8knad. Den kan sendes inn, eller en bruker kan velge \u00e5 ikke sende den inn.","title":"Utkast p\u00e5 min side"},{"location":"utkast/#hvordan-fungerer-det","text":"Koble p\u00e5 min-side-utkast-iac-topicet og kj\u00f8r p\u00e5! \\ utkast st\u00f8tter tre hendelser: created, updated, og deleted 1. Send en created-melding n\u00e5r en bruker har lagra ett utkast 2. Send en updated-melding hvis url-en eller tittelen til utkastet har endret seg. 3. Send en deleted melding n\u00e5r bruker enten har sendt inn eller hvis utkastet har blitt slettet enten av bruker eller systemet.","title":"Hvordan fungerer det?"},{"location":"utkast/#kafka","text":"topic : aapen-utkast-v1 \\ tilgang : min-side-utkast-iac-topic \\ hendelser : created , updated , deleted","title":"Kafka"},{"location":"utkast/#meldingsformat","text":"","title":"meldingsformat"},{"location":"utkast/#create-og-update","text":"{ \"@event_name\": \"<operasjon>\", \"utkastId\": \"<uuid>\", \"ident\": \"<fnr eller lignende>\", \"link\": \"<link til utkast>\", \"tittel\": \"<tittel p\u00e5 utkast>\", \"tittel_i18n\": { \"<spr\u00e5kkode>\": \"oversatt tittel\" }, \"metrics\": { \"skjemanavn\": \"<skjema navn>\", \"skjemakode\": \"<NAV skjemakode>\" } } obligatoriske felt : @event_name , utkastId , \"ident\" , \"tittel\"","title":"create og update"},{"location":"utkast/#delete","text":"{ \"@event_name\": \"deleted\", \"utkastId\": \"<uuid>\" } Det finnes ogs\u00e5 et message-builder bibliotek som lager meldingene for deg. NB! Det er kun ting som ikke er innsendt som skal ligge p\u00e5 utkast-siden.","title":"delete"},{"location":"utkast/#observability","text":"Hendelser blir logget til kibana med customfelter for filtrering \\ Alle utkast: x_contenttype:\"utkast\" \\ Spesifikt utkast: x_minside_id :\"<utkastid>\"","title":"Observability"},{"location":"utkast/#amplitude-malinger","text":"Utkast-frontenden logger ett skjema \u00e5pent event med url som payload til amplitude n\u00e5r bruker klikker p\u00e5 ett utkast. Om teamet ditt \u00f8nsker \u00e5 f\u00e5 med feltene skjemakode og skjemanavn m\u00e5 metricsfeltet v\u00e6re tilstede og komplett i create-meldingen","title":"Amplitude m\u00e5linger"},{"location":"varsler/","text":"Varsler p\u00e5 min side Varsler gj\u00f8r det mulig \u00e5 sende beskjeder og oppgaver til en bruker som vises i varselbjella og p\u00e5 varselsiden via kafka. Varslene skal inaktiveres hvis de ikke er relevante lengre. Inaktiverte varsler vil fortsatt v\u00e6re tilgjengelig p\u00e5 tidligere varsler siden . Produsere varsel-hendelser Konsumere varsel Migrere fra AVRO-topic","title":"Oversikt"},{"location":"varsler/#varsler-pa-min-side","text":"Varsler gj\u00f8r det mulig \u00e5 sende beskjeder og oppgaver til en bruker som vises i varselbjella og p\u00e5 varselsiden via kafka. Varslene skal inaktiveres hvis de ikke er relevante lengre. Inaktiverte varsler vil fortsatt v\u00e6re tilgjengelig p\u00e5 tidligere varsler siden . Produsere varsel-hendelser Konsumere varsel Migrere fra AVRO-topic","title":"Varsler p\u00e5 min side"},{"location":"varsler/konsumere/","text":"Lytte p\u00e5 aktiverte og inaktiverte varsler Topic: aapen-varsel-hendelse Tilgang: aapen-varsel-hendelse-iac Eksempler Oppgave med eventId \"123\" mottat fra produsent \"team-alfabet:abc\" og lagret i database. { \"@event_name\": \"aktivert\", \"varselType\": \"oppgave\", \"eventId\": \"123\", \"namespace\": \"team-alfabet\", \"appnavn\": \"abc\" } Beskjed med eventId \"456\", opprettet av app \"team-alfabet:def\", fjernet av bruker. { \"@event_name\": \"inaktivert\", \"varselType\": \"beskjed\", \"eventId\": \"456\", \"namespace\": \"team-alfabet\", \"appnavn\": \"def\" }","title":"Konsumere varsler"},{"location":"varsler/konsumere/#lytte-pa-aktiverte-og-inaktiverte-varsler","text":"Topic: aapen-varsel-hendelse Tilgang: aapen-varsel-hendelse-iac","title":"Lytte p\u00e5 aktiverte og inaktiverte varsler"},{"location":"varsler/konsumere/#eksempler","text":"Oppgave med eventId \"123\" mottat fra produsent \"team-alfabet:abc\" og lagret i database. { \"@event_name\": \"aktivert\", \"varselType\": \"oppgave\", \"eventId\": \"123\", \"namespace\": \"team-alfabet\", \"appnavn\": \"abc\" } Beskjed med eventId \"456\", opprettet av app \"team-alfabet:def\", fjernet av bruker. { \"@event_name\": \"inaktivert\", \"varselType\": \"beskjed\", \"eventId\": \"456\", \"namespace\": \"team-alfabet\", \"appnavn\": \"def\" }","title":"Eksempler"},{"location":"varsler/migrere/","text":"Migrere fra AVRO Topic Alle meldinger skal produseres til det samme topicet opprett pr i github-repository . Endringer i meldingene En del felter er fjernet, se produsere varsler for nytt format og meldingsbyggere meldingstyper Tidligere har det v\u00e6rt fire meldingstyper (beskjed, oppgave, innboks, done). Disse er n\u00e5 sl\u00e5tt sammen til 2 objekter; opprett og inaktiver. Varseltypen spesifiseres i opprett-eventet. feltnavn eventId -> varselId sikkerhetsnivaa -> sensitivitet (3 -> substantial, 4 -> high) synligFremTil -> aktivFremTil fodselsnummer -> ident tekst: Det er anbefalt \u00e5 legge til tekst for flere spr\u00e5k, alle tekster m\u00e5 ha en spr\u00e5kkode. Om det er tekst p\u00e5 flere spr\u00e5k, m\u00e5 1 v\u00e6re satt som default.","title":"Migrere fra AVRO"},{"location":"varsler/migrere/#migrere-fra-avro","text":"","title":"Migrere fra AVRO"},{"location":"varsler/migrere/#topic","text":"Alle meldinger skal produseres til det samme topicet opprett pr i github-repository .","title":"Topic"},{"location":"varsler/migrere/#endringer-i-meldingene","text":"En del felter er fjernet, se produsere varsler for nytt format og meldingsbyggere","title":"Endringer i meldingene"},{"location":"varsler/migrere/#meldingstyper","text":"Tidligere har det v\u00e6rt fire meldingstyper (beskjed, oppgave, innboks, done). Disse er n\u00e5 sl\u00e5tt sammen til 2 objekter; opprett og inaktiver. Varseltypen spesifiseres i opprett-eventet.","title":"meldingstyper"},{"location":"varsler/migrere/#feltnavn","text":"eventId -> varselId sikkerhetsnivaa -> sensitivitet (3 -> substantial, 4 -> high) synligFremTil -> aktivFremTil fodselsnummer -> ident","title":"feltnavn"},{"location":"varsler/migrere/#tekst","text":"Det er anbefalt \u00e5 legge til tekst for flere spr\u00e5k, alle tekster m\u00e5 ha en spr\u00e5kkode. Om det er tekst p\u00e5 flere spr\u00e5k, m\u00e5 1 v\u00e6re satt som default.","title":"tekst:"},{"location":"varsler/produsere/","text":"Komme i gang med varsler For brukeropplevelsen er det viktig at du bruker riktig type varsel. Ta gjerne en ekstrasjekk med innholdsguiden v\u00e5r . Kafka tilgang: Opprett en pull-request mot topic aapen-brukervarsel-v1 i min-side-brukervarsel-topic-iac . Koble p\u00e5 topicene. Send event! Varseltyper type beskrivelse Deaktiveres av Beskjed For korte p\u00e5minnelser eller oppdatering av status Bruker, produsent, eller min side hvis aktivFremTil dato er satt og dato er passert. Oppgave For noe som m\u00e5 bli utf\u00f8rt Produsent n\u00e5r oppgaven er utf\u00f8rt ( inaktiver-event), eller av min side hvis aktivFremTil dato er satt eller varslet har v\u00e6rt aktivt i mer enn ett \u00e5r. Innboks For varsler om digitale innbokser andre steder i NAV Produsent NB! Det er viktig \u00e5 huske \u00e5 sende inaktiver-event for oppgave-varsler. hvis ikke vil det se ut for personen som at oppgaven ikke er utf\u00f8rt. Alle varsler slettes 1 \u00e5r etter mottaksdato. Ekstern varsling Produsent kan velge om bruker ogs\u00e5 skal varsles via eksterne kanaler (sms og epost). Produsent kan velge preferert kanal, og hvorvidt standardtekst skal overskrives. Standardtekst er av typen: Hei! Du har f\u00e5tt en ny <varseltype> fra NAV. Logg inn p\u00e5 NAV for \u00e5 se hva varselet gjelder. Vennlig hilsen NAV Eksterne varseltekster skal ikke inneholde lenker. Det er ogs\u00e5 produsentens ansvar \u00e5 ikke sende sensitiv informasjon p\u00e5 epost og sms. Revarsling Varsler med typen oppgave eller innboks f\u00e5r automatisk revarsling dersom varselet ikke er ferdigstilt etter et bestemt antall dager. Oppgaver blir revarsler etter 7 dager, og innboks blir revarslet etter 4 dager. Overskriving av standardtekster Dersom en velger \u00e5 overskrive standardtekster for epost/sms, er det anbefalt \u00e5 overskrive samtlige tekster, selv om kun 1 kanal er preferert. Dette er fordi bruker kan motta varsler via annen kanal enn preferansen. Overv\u00e5king av varsler Produsenter kan lytte p\u00e5 topic aapen-varsel-hendelse-v1 for \u00e5 f\u00f8lge med p\u00e5 status p\u00e5 varsler. Per i dag er det kun mulig \u00e5 lytte p\u00e5 n\u00e5r varsler aktiveres/inaktiveres. Det vil etter hvert bli mulig \u00e5 lytte p\u00e5 status for eksern varslign og andre typer hendelser. Produsenter som \u00f8nsker \u00e5 lytte p\u00e5 status for ekstern varsling har ogs\u00e5 mulighet til \u00e5 lytte direkte p\u00e5 topic aapen-dok-notifikasjon-status til\u00f8rende team dokumenth\u00e5ndtering. Kafka, schemas og buildere Min side varsler bruker ikke lenger Avro for schema-validering og serialisering. Produsenter sender eventer direkte p\u00e5 json-format. Vi tilbyr to sett med buildere for henholdsvis java- og kotlin-prosjekter. Det er ikke strengt n\u00f8dvendig \u00e5 bruke disse, men sterkt anbefalt. Builderne s\u00f8rger for at format er riktig og har gj\u00f8r forh\u00e5ndsvalidering av innhold. Det er ogs\u00e5 anbefalt \u00e5 bruke varselId som kafka-n\u00f8kkel, for \u00e5 opprettholde kronologi per enkelt varsel. Builderne finnes i f\u00f8lgende bibliotek: Github Maven repository kotlin: no.nav.tms.varsel:kotlin-builder:1.0.0 java: no.nav.tms.varsel:java-builder:1.0.0 Husk \u00e5 legge til autentisert repository https://maven.pkg.github.com/navikt/tms-varsel-authority Oppretting av varsel For \u00e5 gi varsel til bruker sender en et opprett-varsel event. Opprett-varsel felter felt p\u00e5krevd beskrivelse restriksjoner tillegginfo type ja Type p\u00e5 varsel (beskjed, oppgave, innboks) M\u00e5 v\u00e6re \u00e9n av beskjed , oppgave , innboks varselId ja Id til varselet. Produsenten bruker samme Id til \u00e5 inaktivere varsel M\u00e5 v\u00e6re UUID eller ULID ident ja Fodselsnummer (evt. d-nummer eller tilsvarende) til mottaker av varsel M\u00e5 ha 11 siffer tekster ja, minst 1 Teksten som faktisk vises i varselet med spr\u00e5kkode. Dersom flere tekster p\u00e5 ulike spr\u00e5k er gitt m\u00e5 \u00e9n tekst v\u00e6re satt som default Spr\u00e5kkode m\u00e5 f\u00f8lge ISO-639 (typen no , nb , en ...) link ikke for beskjed Lenke som blir aktivert n\u00e5r en person trykker p\u00e5 varselet i varselbjella eller p\u00e5 min side Komplett URL, inkludert https protokoll. sensitivitet ja p\u00e5krevd level-of-assurance for \u00e5 kunne se innhold i varsel \u00c9n av high , substantial high og substantial tilsvarer det som tidligere var henholdvis niv\u00e5 4 og 3 . Hvis personen har varsler med sensitivitet high , men er logget inn med LoA substantial , vil hen se type varsel, men ikke innholdet. aktivFremTil nei Tidspunkt for n\u00e5r varslet skal inaktiverer automatisk av systemet Tidspunkt med tidssone. UTC eller Z er anbefalt St\u00f8ttes ikke for Innboks-varsler eksternVarsling nei Om det skal sendes sms og/eller epost til mottaker Kan kun velge preferert kanal SMS eller EPOST . Dersom ekstern varslingstekst ikke er satt blir det sendt en standardtekst. produsent ja Teknisk kilde til varsel-eventet Ingen spesielle Buildere vil fors\u00f8ke \u00e5 hente dette automatisk basert p\u00e5 nais-milj\u00f8variabler. Der disse ikke er tilgjengelige m\u00e5 produsent settes manuelt. Json-format { \"@event_name\": \"opprett\", \"type\": \"<type>\", \"varselId\": \"<varselId>\", \"ident\": \"<ident>\", \"tekster\": [ { \"spraakkode\": \"<spraakkode>\", \"tekst\": \"<tekst>\", \"default\": true } ], \"link\": \"<link>\", \"sensitivitet\": \"<sensitivitet>\", \"aktivFremTil\": \"<aktivFremTil>\", \"eksternVarsling\": { \"prefererteKanaler\": [\"SMS\", \"EPOST\"], \"smsVarslingstekst\": \"<smsTekst>\", \"epostVarslingstittel\": \"epostTittel\", \"epostVarslingstekst\": \"epostTekst\" }, \"produsent\": { \"cluster\": \"<cluster>\", \"namespace\": \"<namespace>\", \"appnavn\": \"<appnavn>\" } } Eksempel med buildere Eksempel p\u00e5 oppretting av Oppgave-varsel for bruker 12345678901 med id aabbccdd-abcd-1234-5678-abcdef123456 . Varselet skal: - ha sensitivitet high - lenke til https://www.nav.no - l\u00f8pe ut 14 dager etter oppretting - ha en norsk (default) og en engelsk tekst - varsles p\u00e5 sms med standardtekst. Med kotlin-builder val kafkaValueJson = VarselActionBuilder.opprett { type = Varseltype.Oppgave varselId = \"aabbccdd-abcd-1234-5678-abcdef123456\" sensitivitet = Sensitivitet.High ident = \"12345678901\" tekster += Tekst( spraakkode = \"nb\", tekst = \"Norsk tekst\", default = true ) tekster += Tekst( spraakkode = \"en\", tekst = \"English text\", default = false ) link = \"https://www.nav.no\" aktivFremTil = ZonedDateTime.now(ZoneId.of(\"Z\")).plusDays(14) eksternVarsling = EksternVarslingBestilling(prefererteKanaler = listOf(EksternKanal.SMS)) } Med java-builder String kafkaValueJson = OpprettVarselBuilder.newInstance() .withType(Varseltype.Oppgave) .withVarselId(\"aabbccdd-abcd-1234-5678-abcdef123456\") .withSensitivitet(Sensitivitet.High) .withIdent(\"12345678901\") .withTekst(\"nb\", \"Norsk tekst\", true) .withTekst(\"en\", \"English text\", false) .withLink(\"https://www.nav.no\") .withAktivFremTil(ZonedDateTime.now(ZoneId.of(\"Z\")).plusDays(14)) .withEksternVarsling(EksternKanal.SMS) .build(); Inaktivering av varsel Oppgave- og innboks-varsler inaktiveres av produsent. Dette gj\u00f8r en ved \u00e5 sende et inaktiver-event. Inaktiver-varsel felter felt p\u00e5krevd beskrivelse tillegginfo varselId ja Id til varselet som skal inaktiveres produsent ja Teknisk kilde til varsel-eventet Buildere vil fors\u00f8ke \u00e5 hente dette automatisk basert p\u00e5 nais-milj\u00f8variabler. Der disse ikke er tilgjengelige m\u00e5 produsent settes manuelt. Json-format { \"@event_name\": \"inaktiver\", \"varselId\": \"<varselId>\", \"produsent\": { \"cluster\": \"<cluster>\", \"namespace\": \"<namespace>\", \"appnavn\": \"<appnavn>\" } } Eksempel med buildere Eksempel p\u00e5 inaktivering av varsel med id aabbccdd-abcd-1234-5678-abcdef123456 . Med kotlin-builder val kafkaValueJson = VarselActionBuilder.inaktiver { varselId = \"aabbccdd-abcd-1234-5678-abcdef123456\" } Med java-builder String kafkaValueJson = InaktiverVarselBuilder.newInstance() .withVarselId(\"aabbccdd-abcd-1234-5678-abcdef123456\") .build();","title":"Produsere varsler"},{"location":"varsler/produsere/#komme-i-gang-med-varsler","text":"For brukeropplevelsen er det viktig at du bruker riktig type varsel. Ta gjerne en ekstrasjekk med innholdsguiden v\u00e5r . Kafka tilgang: Opprett en pull-request mot topic aapen-brukervarsel-v1 i min-side-brukervarsel-topic-iac . Koble p\u00e5 topicene. Send event!","title":"Komme i gang med varsler"},{"location":"varsler/produsere/#varseltyper","text":"type beskrivelse Deaktiveres av Beskjed For korte p\u00e5minnelser eller oppdatering av status Bruker, produsent, eller min side hvis aktivFremTil dato er satt og dato er passert. Oppgave For noe som m\u00e5 bli utf\u00f8rt Produsent n\u00e5r oppgaven er utf\u00f8rt ( inaktiver-event), eller av min side hvis aktivFremTil dato er satt eller varslet har v\u00e6rt aktivt i mer enn ett \u00e5r. Innboks For varsler om digitale innbokser andre steder i NAV Produsent NB! Det er viktig \u00e5 huske \u00e5 sende inaktiver-event for oppgave-varsler. hvis ikke vil det se ut for personen som at oppgaven ikke er utf\u00f8rt. Alle varsler slettes 1 \u00e5r etter mottaksdato.","title":"Varseltyper"},{"location":"varsler/produsere/#ekstern-varsling","text":"Produsent kan velge om bruker ogs\u00e5 skal varsles via eksterne kanaler (sms og epost). Produsent kan velge preferert kanal, og hvorvidt standardtekst skal overskrives. Standardtekst er av typen: Hei! Du har f\u00e5tt en ny <varseltype> fra NAV. Logg inn p\u00e5 NAV for \u00e5 se hva varselet gjelder. Vennlig hilsen NAV Eksterne varseltekster skal ikke inneholde lenker. Det er ogs\u00e5 produsentens ansvar \u00e5 ikke sende sensitiv informasjon p\u00e5 epost og sms.","title":"Ekstern varsling"},{"location":"varsler/produsere/#revarsling","text":"Varsler med typen oppgave eller innboks f\u00e5r automatisk revarsling dersom varselet ikke er ferdigstilt etter et bestemt antall dager. Oppgaver blir revarsler etter 7 dager, og innboks blir revarslet etter 4 dager.","title":"Revarsling"},{"location":"varsler/produsere/#overskriving-av-standardtekster","text":"Dersom en velger \u00e5 overskrive standardtekster for epost/sms, er det anbefalt \u00e5 overskrive samtlige tekster, selv om kun 1 kanal er preferert. Dette er fordi bruker kan motta varsler via annen kanal enn preferansen.","title":"Overskriving av standardtekster"},{"location":"varsler/produsere/#overvaking-av-varsler","text":"Produsenter kan lytte p\u00e5 topic aapen-varsel-hendelse-v1 for \u00e5 f\u00f8lge med p\u00e5 status p\u00e5 varsler. Per i dag er det kun mulig \u00e5 lytte p\u00e5 n\u00e5r varsler aktiveres/inaktiveres. Det vil etter hvert bli mulig \u00e5 lytte p\u00e5 status for eksern varslign og andre typer hendelser. Produsenter som \u00f8nsker \u00e5 lytte p\u00e5 status for ekstern varsling har ogs\u00e5 mulighet til \u00e5 lytte direkte p\u00e5 topic aapen-dok-notifikasjon-status til\u00f8rende team dokumenth\u00e5ndtering.","title":"Overv\u00e5king av varsler"},{"location":"varsler/produsere/#kafka-schemas-og-buildere","text":"Min side varsler bruker ikke lenger Avro for schema-validering og serialisering. Produsenter sender eventer direkte p\u00e5 json-format. Vi tilbyr to sett med buildere for henholdsvis java- og kotlin-prosjekter. Det er ikke strengt n\u00f8dvendig \u00e5 bruke disse, men sterkt anbefalt. Builderne s\u00f8rger for at format er riktig og har gj\u00f8r forh\u00e5ndsvalidering av innhold. Det er ogs\u00e5 anbefalt \u00e5 bruke varselId som kafka-n\u00f8kkel, for \u00e5 opprettholde kronologi per enkelt varsel. Builderne finnes i f\u00f8lgende bibliotek:","title":"Kafka, schemas og buildere"},{"location":"varsler/produsere/#github-maven-repository","text":"kotlin: no.nav.tms.varsel:kotlin-builder:1.0.0 java: no.nav.tms.varsel:java-builder:1.0.0 Husk \u00e5 legge til autentisert repository https://maven.pkg.github.com/navikt/tms-varsel-authority","title":"Github Maven repository"},{"location":"varsler/produsere/#oppretting-av-varsel","text":"For \u00e5 gi varsel til bruker sender en et opprett-varsel event.","title":"Oppretting av varsel"},{"location":"varsler/produsere/#opprett-varsel-felter","text":"felt p\u00e5krevd beskrivelse restriksjoner tillegginfo type ja Type p\u00e5 varsel (beskjed, oppgave, innboks) M\u00e5 v\u00e6re \u00e9n av beskjed , oppgave , innboks varselId ja Id til varselet. Produsenten bruker samme Id til \u00e5 inaktivere varsel M\u00e5 v\u00e6re UUID eller ULID ident ja Fodselsnummer (evt. d-nummer eller tilsvarende) til mottaker av varsel M\u00e5 ha 11 siffer tekster ja, minst 1 Teksten som faktisk vises i varselet med spr\u00e5kkode. Dersom flere tekster p\u00e5 ulike spr\u00e5k er gitt m\u00e5 \u00e9n tekst v\u00e6re satt som default Spr\u00e5kkode m\u00e5 f\u00f8lge ISO-639 (typen no , nb , en ...) link ikke for beskjed Lenke som blir aktivert n\u00e5r en person trykker p\u00e5 varselet i varselbjella eller p\u00e5 min side Komplett URL, inkludert https protokoll. sensitivitet ja p\u00e5krevd level-of-assurance for \u00e5 kunne se innhold i varsel \u00c9n av high , substantial high og substantial tilsvarer det som tidligere var henholdvis niv\u00e5 4 og 3 . Hvis personen har varsler med sensitivitet high , men er logget inn med LoA substantial , vil hen se type varsel, men ikke innholdet. aktivFremTil nei Tidspunkt for n\u00e5r varslet skal inaktiverer automatisk av systemet Tidspunkt med tidssone. UTC eller Z er anbefalt St\u00f8ttes ikke for Innboks-varsler eksternVarsling nei Om det skal sendes sms og/eller epost til mottaker Kan kun velge preferert kanal SMS eller EPOST . Dersom ekstern varslingstekst ikke er satt blir det sendt en standardtekst. produsent ja Teknisk kilde til varsel-eventet Ingen spesielle Buildere vil fors\u00f8ke \u00e5 hente dette automatisk basert p\u00e5 nais-milj\u00f8variabler. Der disse ikke er tilgjengelige m\u00e5 produsent settes manuelt.","title":"Opprett-varsel felter"},{"location":"varsler/produsere/#json-format","text":"{ \"@event_name\": \"opprett\", \"type\": \"<type>\", \"varselId\": \"<varselId>\", \"ident\": \"<ident>\", \"tekster\": [ { \"spraakkode\": \"<spraakkode>\", \"tekst\": \"<tekst>\", \"default\": true } ], \"link\": \"<link>\", \"sensitivitet\": \"<sensitivitet>\", \"aktivFremTil\": \"<aktivFremTil>\", \"eksternVarsling\": { \"prefererteKanaler\": [\"SMS\", \"EPOST\"], \"smsVarslingstekst\": \"<smsTekst>\", \"epostVarslingstittel\": \"epostTittel\", \"epostVarslingstekst\": \"epostTekst\" }, \"produsent\": { \"cluster\": \"<cluster>\", \"namespace\": \"<namespace>\", \"appnavn\": \"<appnavn>\" } }","title":"Json-format"},{"location":"varsler/produsere/#eksempel-med-buildere","text":"Eksempel p\u00e5 oppretting av Oppgave-varsel for bruker 12345678901 med id aabbccdd-abcd-1234-5678-abcdef123456 . Varselet skal: - ha sensitivitet high - lenke til https://www.nav.no - l\u00f8pe ut 14 dager etter oppretting - ha en norsk (default) og en engelsk tekst - varsles p\u00e5 sms med standardtekst.","title":"Eksempel med buildere"},{"location":"varsler/produsere/#med-kotlin-builder","text":"val kafkaValueJson = VarselActionBuilder.opprett { type = Varseltype.Oppgave varselId = \"aabbccdd-abcd-1234-5678-abcdef123456\" sensitivitet = Sensitivitet.High ident = \"12345678901\" tekster += Tekst( spraakkode = \"nb\", tekst = \"Norsk tekst\", default = true ) tekster += Tekst( spraakkode = \"en\", tekst = \"English text\", default = false ) link = \"https://www.nav.no\" aktivFremTil = ZonedDateTime.now(ZoneId.of(\"Z\")).plusDays(14) eksternVarsling = EksternVarslingBestilling(prefererteKanaler = listOf(EksternKanal.SMS)) }","title":"Med kotlin-builder"},{"location":"varsler/produsere/#med-java-builder","text":"String kafkaValueJson = OpprettVarselBuilder.newInstance() .withType(Varseltype.Oppgave) .withVarselId(\"aabbccdd-abcd-1234-5678-abcdef123456\") .withSensitivitet(Sensitivitet.High) .withIdent(\"12345678901\") .withTekst(\"nb\", \"Norsk tekst\", true) .withTekst(\"en\", \"English text\", false) .withLink(\"https://www.nav.no\") .withAktivFremTil(ZonedDateTime.now(ZoneId.of(\"Z\")).plusDays(14)) .withEksternVarsling(EksternKanal.SMS) .build();","title":"Med java-builder"},{"location":"varsler/produsere/#inaktivering-av-varsel","text":"Oppgave- og innboks-varsler inaktiveres av produsent. Dette gj\u00f8r en ved \u00e5 sende et inaktiver-event.","title":"Inaktivering av varsel"},{"location":"varsler/produsere/#inaktiver-varsel-felter","text":"felt p\u00e5krevd beskrivelse tillegginfo varselId ja Id til varselet som skal inaktiveres produsent ja Teknisk kilde til varsel-eventet Buildere vil fors\u00f8ke \u00e5 hente dette automatisk basert p\u00e5 nais-milj\u00f8variabler. Der disse ikke er tilgjengelige m\u00e5 produsent settes manuelt.","title":"Inaktiver-varsel felter"},{"location":"varsler/produsere/#json-format_1","text":"{ \"@event_name\": \"inaktiver\", \"varselId\": \"<varselId>\", \"produsent\": { \"cluster\": \"<cluster>\", \"namespace\": \"<namespace>\", \"appnavn\": \"<appnavn>\" } }","title":"Json-format"},{"location":"varsler/produsere/#eksempel-med-buildere_1","text":"Eksempel p\u00e5 inaktivering av varsel med id aabbccdd-abcd-1234-5678-abcdef123456 .","title":"Eksempel med buildere"},{"location":"varsler/produsere/#med-kotlin-builder_1","text":"val kafkaValueJson = VarselActionBuilder.inaktiver { varselId = \"aabbccdd-abcd-1234-5678-abcdef123456\" }","title":"Med kotlin-builder"},{"location":"varsler/produsere/#med-java-builder_1","text":"String kafkaValueJson = InaktiverVarselBuilder.newInstance() .withVarselId(\"aabbccdd-abcd-1234-5678-abcdef123456\") .build();","title":"Med java-builder"}]}